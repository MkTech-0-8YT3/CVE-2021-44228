package com.log4shell.web;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.web.bind.annotation.*;

@RestController
public class LogController {

    private static final Logger VULN_LOGGER = LogManager.getLogger(LogController.class);

    @PostMapping("/logAction")
    public String logAction(@RequestParam String payload) {
        //Below line can be removed/commented if older Java version is used (i.e. java 8u181)
        System.setProperty("com.sun.jndi.ldap.object.trustURLCodebase","true");
        VULN_LOGGER.error(payload);
        return "Logged: " + payload + "<br/><a href=\"../\">Go back</a>";
    }
}
